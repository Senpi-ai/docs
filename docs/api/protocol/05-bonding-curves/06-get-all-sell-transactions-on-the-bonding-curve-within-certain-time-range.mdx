---
description: Learn how to use the Moxie Protocol Subgraph API to get all the sell transactions on the Moxie bonding curves within a certain time range.
---

import InstallDependencies from "../../../../partial/_install_dependencies.mdx";
import PreRequisites from "../../../../partial/_pre_requisites.mdx";
import DeveloperSupport from "../../../../partial/_developer_support.mdx";
import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# Get All Sell Transactions On The Bonding Curves Within Certain Time Range

In this tutorial, you will learn how to get all the sell transactions on the Moxie bonding curves within a certain time range by calling the Moxie Protocol Subgraph API.

<PreRequisites />

<InstallDependencies />

## Step 2: Construct The GraphQL Query

Then, you can get all the purchase transactions on the Moxie bonding curves within a certain time range by calling the subgraph API with the following query:

<Tabs>
<TabItem value="query" label="Query">

```graphql
query MyQuery($startTime: BigInt, $endTime: BigInt) {
  moxieBondingCurveSubjectSharePurchasedTxes(
    where: {
      blockInfo_: { timestamp_gte: $startTime, timestamp_lte: $endTime }
    }
  ) {
    beneficiary
    buyAmount
    subject
    sellAmount
    sellToken
    txHash
    blockInfo {
      blockNumber
      hash
      timestamp
    }
  }
}
```

</TabItem>
<TabItem value="variable" label="Variable">

```json
{
  "startTime": "1720630000",
  "endTime": "1720640000"
}
```

</TabItem>
<TabItem value="response" label="Response">

```json
{
  "data": {
    "moxieBondingCurveSubjectSharePurchasedTxes": [
      {
        "beneficiary": "0x9313ede439fc91852d4fd8f753c5569255286790",
        "buyAmount": "1999999720627949785464",
        "subject": "0x3e0ea0e39dc5af19d5fd53b2628899b53ce3497b",
        "sellAmount": "2656194000000000000000000",
        "sellToken": "0xf80945fc1436b0ae8b86c8835f09870deeaf03d5",
        "txHash": "0x0065d3f3246d5e61781a1a5424c6686d247532167ce7214beffef38732dc9ed8",
        "blockInfo": {
          "blockNumber": "12434710",
          "hash": "0xa9f03ff3c90fe0f4901dd6772d5557a8fd2869807fb47981df9af650194eaa81",
          "timestamp": "1720637708"
        }
      }
    ]
  }
}
```

</TabItem>
</Tabs>

## Step 3: Add The API Query To Your Code

With this GraphQL query, you can add it to your source code:

<Tabs>
<TabItem value="grapqhl_ts" label="graphql-request (TS)">

```tsx
import { gql, GraphQLClient } from "graphql-request";

const query = gql`
  query MyQuery($startTime: BigInt, $endTime: BigInt) {
    moxieBondingCurveSubjectSharePurchasedTxes(
      where: {
        blockInfo_: { timestamp_gte: $startTime, timestamp_lte: $endTime }
      }
    ) {
      beneficiary
      buyAmount
      subject
      sellAmount
      sellToken
      txHash
      blockInfo {
        blockNumber
        hash
        timestamp
      }
    }
  }
`;

const graphQLClient = new GraphQLClient(
  "https://api.studio.thegraph.com/proxy/27864/protocol/v3.1.9"
);

try {
  const data = await graphQLClient.request(query, {
    startTime: "1720630000",
    endTime: "1720640000",
  });
  console.log(data);
} catch (e) {
  throw new Error(e);
}
```

</TabItem>
<TabItem value="graphql_js" label="graphql-request (JS)">

```jsx
const { gql, GraphQLClient } = require("graphql-request");

const query = gql`
  query MyQuery($startTime: BigInt, $endTime: BigInt) {
    moxieBondingCurveSubjectSharePurchasedTxes(
      where: {
        blockInfo_: { timestamp_gte: $startTime, timestamp_lte: $endTime }
      }
    ) {
      beneficiary
      buyAmount
      subject
      sellAmount
      sellToken
      txHash
      blockInfo {
        blockNumber
        hash
        timestamp
      }
    }
  }
`;

const graphQLClient = new GraphQLClient(
  "https://api.studio.thegraph.com/proxy/27864/protocol/v3.1.9"
);

try {
  const data = await graphQLClient.request(query, {
    startTime: "1720630000",
    endTime: "1720640000",
  });
  console.log(data);
} catch (e) {
  throw new Error(e);
}
```

</TabItem>
</Tabs>

<DeveloperSupport />
