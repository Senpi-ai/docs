# Based Rewards

**Based Rewards** is the amount of Moxie that a user will automatically earn for every eligibile transaction that they execute on [Base](https://base.org).

In this tutorial, you will explore the key parameters and concepts used to calculate Based Rewards. An example is also provided at the end to illustrate these concepts in action.

## Pre-requisites

- Read the [Moxie Scores](./03-moxie-score.mdx) page.

## Multipliers

A **multiplier value** is applied to each eligible transaction, depending on the amount of protocol fees paid by the user to the allowlisted protocol contract that the user interacts with.

The applicable multipliers are as follows based on the percentage of protocol fees paid per transactions:

| **Transaction Type**                                                     | **Multiplier Value** |
| ------------------------------------------------------------------------ | -------------------- |
| Tx on allowlisted contracts with protocol fee $F \le 0.25\%$             | $1\times$            |
| Tx on allowlisted contracts with protocol fee $0.25\% \lt  F \leq 0.5\%$ | $2\times$            |
| Tx on allowlisted contracts with protocol fee $0.5\% \lt F \leq 0.75\%$  | $3\times$            |
| Tx on allowlisted contracts with protocol fee $F \gt 0.75\%$             | $4\times$            |
| Tx on Moxie Bonding Curve & Staking (Creator Coins Transactions)         | $4\times$            |
| Tx on Non-Allowlisted Contracts                                          | $0\times$            |

To view the current contracts allowlisted and their associated fees and multipliers assigned, click [here](https://dune.com/queries/4542828).

## Total Gas Used

The **Total Gas Used** by a user $U$ is calculated as the sum of all gas fees (in gwei), multiplied by a multiplier value, for all **eligible transactions** completed by the user within a single day.

A transaction is considered **eligible** for this calculation if it satisfies both of the following conditions:

1. The `to` address of the transaction must belong to one of the **allowlisted contracts** on Moxie. These contracts, listed [here](https://dune.com/queries/4542828), are selected from the top 50 Base protocols with user fees.
1. The **value** of the transaction must be at least $5, which can have either Ether or ERC20 tokens transferred within the transactions.

:::info[Based Rewards Partner]

Based rewards program is a great opportunity for builders on Base to increase the usage of their app, grow the user base, and get a greater level of exposure through the Moxie ecosystem.

As a **Based Rewards Partner**, all eligible contract addresses from your project will be allowlisted, and Moxie users will be to earn rewards when interacting with your contracts onchain.

To apply to be a **Based Rewards Partner**, click on this link [here](https://app.deform.cc/form/a1eef1fd-fcb8-4469-b579-07bf1cb7d579/?page_number=0).

:::

Using the criteria and multipliers above, given user $U$ has made transactions $tx_1, tx_2, ..., tx_j$ on the Base chain, then the **Total Gas Used** for user $U$ can be formulated using the following equations:

$$
G_{used}(U) = \sum_{i=1}^j m(tx_{i}) \times E(tx_{i}) \times G(tx_{i})
$$

<br />

where:

| Notation      | Description                                                                                                                         |
| ------------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| $G_{used}(U)$ | Total gas used by user $$U$$ on [Base](https://base.org).                                                                           |
| $m(tx_{i})$   | Multiplier on transaction $tx_{i}$, which is based the protocol fee paid. Check details in [Multiplier tables](#multipliers) above. |
| $E(tx_{i})$   | If transaction $tx_{i}$ is eligible, return 1. Otherwise, return 0.                                                                 |
| $G(tx_{i})$   | Gas used on transaction $tx_{i}$                                                                                                    |

## Reward & Percentage Contribution

Each day a fixed number of Moxie, represented by variable $M$, will be distributed to all users proportionally based on the % amount they contributed to the pool that day. It is important to keep in mind that the variable $M$ will differ from day to day.

The **Base Usage** of user $U_i$ is defined as the amount contributed to the pool in a given day.

This can be formulated as the sum of the product of the Moxie Score, the total eligible gas spent by each user on Base, and the total USD amount transacted in the day, which can be written as an equation shown below:

$$
B_{usage}(U) = \frac{G_{used}(U)^{0.5} \times 1.2 + T_{USD}(U)^{1.2} + Avg_{USD}(U)^{2.2}}{n_{tx}(U)^{0.65} + Avg_{USD}(U)^{1.4}} \times \biggl( \frac{M_{score}(U)}{1500} \biggl)^{0.45}
$$

where $Avg_{USD}(U)$, that is the average \$USD value spent by user $U$, can be expanded further to:

$$
Avg_{USD}(U) = \frac{T_{USD}(U)}{{n_{tx}(U)}}
$$

By summing up all the Base Usages from all users $U_1, U_2, ..., U_k$, the **Total Base Usage** to the reward pool can be defined as follows:

$$
P = \sum_{i=1}^k B_{usage}(U_i)
$$

And the **Percentage of Contribution** of a user $$U$$ to the pool in a given day can be calculated using the equation below:

$$
\frac{B_{usage}(U)}{P}
$$

Thus, by definition, the Based Rewards of a user $$U$$ can be represented as follows:

$$
B_{rewards}(U) = \frac{B_{usage}(U)}{P} \times M
$$

<br />

where:

| Notation           | Description                                                                                                         |
| ------------------ | ------------------------------------------------------------------------------------------------------------------- |
| $$k$$              | Total number of users                                                                                               |
| $$P$$              | Total amount contributed to the pool in a given day                                                                 |
| $$n_{tx}(U)$$      | Total amount of transactions made by user $U$                                                                       |
| $$B_{usage}(U)$$   | The Base usage by user $U$                                                                                          |
| $$B_{rewards}(U)$$ | Based Rewards of user $$U$$                                                                                         |
| $$M_{score}(U)$$   | [Moxie Score](./03-moxie-score.mdx) of user $$U$$                                                                   |
| $$G_{used}(U)$$    | Total gas used by user $$U$$ on [Base](https://base.org). For more details, read [Total Gas Used](#total-gas-used). |
| $$Avg_{USD}(U)$$   | Average USD amount transacted in the day                                                                            |
| $$T_{USD}(U)$$     | Total USD amount transacted in the day                                                                              |

As shown by the equation above, the amount of Based Rewards is directly proportional to the amount of Moxie Score you have. Thus, the more account you connect to your Moxie profile, the higher amount of Based Rewards you will earn for each transaction on Base.

Similarly, the more active you are on Base, the higher amount of gas on Base you will spend, which will result in higher amount of Based Rewards you will earn for each transaction on Base.

These data is available in Dune publicly where you can fetch the data for your own analysis, projects, or apps. To learn more about this, click [here](../../dune-data/01-overview.mdx).

## Example

Let's consider an example where there are 3 users on Base, and the total amount of Moxie distributed on a given day is 5,000 Moxie. The Moxie Score and gas spent by each user on Base are as follows:

| User  | Moxie Score | Gas Used    | Total USD transacted | Number of Transactions |
| ----- | ----------- | ----------- | -------------------- | ---------------------- |
| $U_1$ | $20$        | $100000000$ | $10$                 | $2$                    |
| $U_2$ | $50$        | $200000000$ | $15$                 | $5$                    |
| $U_3$ | $100$       | $300000000$ | $100$                | $50$                   |

The total amount contributed to the pool in a given day can be calculated as follows:

$$
P = \sum_{i=1}^3 B_{usage}(U_i) = 1051.48
$$

Thus, the % of contribution of each user to the pool will be:

| User  | % Contribution                       |
| ----- | ------------------------------------ |
| $U_1$ | $14.81\% = \frac{B_{usage}(U_1)}{P}$ |
| $U_2$ | $46.66\% = \frac{B_{usage}(U_2)}{P}$ |
| $U_3$ | $38.53\% = \frac{B_{usage}(U_3)}{P}$ |

Finally, the total 5,000 Moxie will be distributed to each user as Based Rewards based on their % contribution to the pool:

| User  | Based Rewards                     |
| ----- | --------------------------------- |
| $U_1$ | $740.56 = 14.81\% \times 5,000$   |
| $U_2$ | $2,333.03 = 46.66\% \times 5,000$ |
| $U_3$ | $1,926.41 = 38.53\% \times 5,000$ |
