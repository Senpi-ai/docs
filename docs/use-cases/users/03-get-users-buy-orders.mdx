---
sidebar_class_name: certain_fan_auction
description: Learn how to use the Moxie Protocol Subgraph API to get the user's buy orders.
---

import Prerequisites from "../../../src/components/Tutorials/Prerequisites";
import DeveloperSupport from "../../../partial/_developer_support.mdx";
import Header from "../../../src/components/Tutorials/Header";
import AddQuery from "../../../src/components/Tutorials/AddQuery";
import ExecuteCode from "../../../src/components/Tutorials/ExecuteCode";
import url from "../../../constant/api_url.json";

# Get User's Buy Orders

<Header useCase="get the user's buy orders" apiName="Moxie Protocol Subgraph" />

:::info[Include User's Vesting Addresses]

Moxie protocol users have Moxie token currently vesting in their vesting contract. A huge portion of them use these to bid on auctions and buy/sell fan tokens on the Moxie protocol.

Therefore, it is important that you include the user's vesting addresses in the query to get all user's buy orders on the Moxie bonding curve. To **get user's vesting contract addresses**, click [**here**](../vesting/01-get-users-vesting-contract-addresses.mdx).

:::

# Pre-requisites

<Prerequisites apiName="Moxie Protocol Subgraph" />

## Step 1: Add The API Query To Your Code

<AddQuery
  useCase="get the user's buy orders"
  subgraphLink={url.protocol_stats_subgraphs}
  query={`query MyQuery($userAddresses: [ID!]) {
  users(where: {id_in: $userAddresses}) {
    orders(where: {orderType: BUY}) {
      price
      protocolToken
      protocolTokenAmount
      protocolFeeTransfer {
        txHash
        amount
      }
      subjectToken {
        name
        symbol
      }
      subjectAmount
      subjectFeeTransfer {
        txHash
        amount
      }
    }
  }
}`}
  variable={`{
  "userAddresses": [
    "0x04e6f111ebf6fd25576d480480962435dc3aa8d8"
  ]
}`}
  response={`{
  "data": {
    "users": [
      {
        "orders": [
          {
            "price": "0.2304086884847426004769468719955685",
            "protocolToken": "0xf86136afb0fb72cdbd27d7aea9e283725d6815a1",
            "protocolTokenAmount": "3000000000000000",
            "protocolFeeTransfer": {
              "txHash": "0x37fa4243f84e41043c490dbed264e61dd4c9992709e0822a80ea2b2e0e809124",
              "amount": "30000000000000"
            },
            "subjectToken": {
              "name": "base",
              "symbol": "cid:base"
            },
            "subjectAmount": "13020342330530893",
            "subjectFeeTransfer": {
              "txHash": "0x37fa4243f84e41043c490dbed264e61dd4c9992709e0822a80ea2b2e0e809124",
              "amount": "90000000000000"
            }
          }
        ]
      }
    ]
  }
}`}
/>

## Step 2: Execute Your Code

<ExecuteCode
  response={`{
  "data": {
    "users": [
      {
        "orders": [
          {
            "price": "0.2304086884847426004769468719955685",
            "protocolToken": "0xf86136afb0fb72cdbd27d7aea9e283725d6815a1",
            "protocolTokenAmount": "3000000000000000",
            "protocolFeeTransfer": {
              "txHash": "0x37fa4243f84e41043c490dbed264e61dd4c9992709e0822a80ea2b2e0e809124",
              "amount": "30000000000000"
            },
            "subjectToken": {
              "name": "base",
              "symbol": "cid:base"
            },
            "subjectAmount": "13020342330530893",
            "subjectFeeTransfer": {
              "txHash": "0x37fa4243f84e41043c490dbed264e61dd4c9992709e0822a80ea2b2e0e809124",
              "amount": "90000000000000"
            }
          }
        ]
      }
    ]
  }
}`}
  dataFetched="all the user's buy orders"
/>

<DeveloperSupport />
